(function(e){function t(t){for(var r,i,s=t[0],l=t[1],c=t[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(f.length)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/vue/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"011c":function(e,t,n){"use strict";n("738f")},"034f":function(e,t,n){"use strict";n("85ec")},1386:function(e,t,n){},"176e":function(e,t,n){},1912:function(e,t,n){"use strict";n("1386")},"1f2b":function(e,t,n){"use strict";n("c4db")},2796:function(e,t,n){},"2c4c":function(e,t,n){"use strict";n("8b30")},"342e":function(e,t,n){},"39ec":function(e,t,n){"use strict";n("7454")},"4dc9":function(e,t,n){},5264:function(e,t,n){"use strict";n("176e")},"56d7":function(e,t,n){"use strict";n.r(t);n("06ea");var r=n("fe2b"),a=(n("0ece"),n("27fd")),o=(n("9b09"),n("6634")),i=(n("c0ed"),n("9fd0")),s=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},c=[],u={name:"APP"},d=u,f=(n("034f"),n("2877")),m=Object(f["a"])(d,l,c,!1,null,null,null),h=m.exports,p=n("8c4f"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("vue-particles",{attrs:{color:"#dedede"}}),n("div",{staticClass:"formContainer"},[n("h3",{staticClass:"lpogintitle"},[e._v("用户登录")]),n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"用户名",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")]),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("注册")])],1)],1)],1)],1)},g=[],v=(n("99af"),n("b0c0"),n("e9c4"),{name:"Login",components:{},data:function(){return{ruleForm:{name:"",password:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:12,message:"长度在 6 到 12 个字符",trigger:"blur"}]}}},computed:{},watch:{},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("请输入所有字段"),!1;t.$axios.get("/users?username=".concat(t.ruleForm.name,"&password=").concat(t.ruleForm.password,"&roleState=true&_expand=role")).then((function(e){console.log(e.data),0===e.data.length?t.$message.error("用户名或密码不匹配"):(localStorage.setItem("token",JSON.stringify(e.data[0])),t.$router.push("/"))}))}))},resetForm:function(e){this.$refs[e].resetFields()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),w=v,y=(n("2c4c"),Object(f["a"])(w,b,g,!1,null,"5e07eae2",null)),_=y.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"news"},[e._m(0),n("el-row",{attrs:{gutter:32}},e._l(e.list,(function(t){return n("el-col",{key:t.id,staticClass:"box",attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v(e._s(t[0]))])]),n("a-list",{attrs:{"item-layout":"vertical",size:"large",pagination:e.pagination,"data-source":t[1]},scopedSlots:e._u([{key:"renderItem",fn:function(t){return n("a-list-item",{key:"item.title"},[n("a-list-item-meta",{attrs:{description:t.description}},[n("router-link",{attrs:{slot:"title",to:"/detail/"+t.id},slot:"title"},[e._v(" "+e._s(t.title))])],1)],1)}}],null,!0)})],1)],1)})),1)],1)},C=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("h3",[e._v("全球大新闻")]),n("span",[e._v("查看新闻")])])}],k=(n("4fad"),{name:"News",components:{},data:function(){return{list:[],pagination:{pageSize:3}}},computed:{},watch:{},methods:{handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this;this.$axios.get("/news?publishState=2&_expand=category").then((function(t){var n=Object.entries(e._.groupBy(t.data,(function(e){return e.category.title})));e.list=n}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),F=k,S=(n("5264"),Object(f["a"])(F,x,C,!1,null,"e955661e",null)),$=S.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail"},[e.newsInfo.title&&e.newsInfo.category.title?n("a-page-header",{attrs:{title:e.newsInfo.title,"sub-title":e.newsInfo.category.title},on:{back:e.back}}):e._e(),n("a-descriptions",{staticStyle:{padding:"0 24px"},attrs:{size:"small"}},[n("a-descriptions-item",{attrs:{label:"发布者"}},[e._v(e._s(e.newsInfo.author)+" ")]),n("a-descriptions-item",{attrs:{label:"发布时间"}},[e._v(" "+e._s(e.time)+" ")]),n("a-descriptions-item",{attrs:{label:"区域"}},[e._v(" "+e._s(e.newsInfo.region)+" ")]),n("a-descriptions-item",{attrs:{label:"访问数量"}},[e._v(" "+e._s(e.newsInfo.view)+" ")]),n("a-descriptions-item",{attrs:{label:"点赞数量"}},[e._v(" "+e._s(e.newsInfo.star)+" "),n("i",{staticClass:"el-icon-thumb",staticStyle:{color:"red","margin-left":"20px"},on:{click:e.handleStar}})]),n("a-descriptions-item",{attrs:{label:"评论数量"}},[e._v(" 0 ")])],1),n("div",{staticStyle:{margin:"0 24px",border:"1px solid gray"},domProps:{innerHTML:e._s(e.newsInfo.content)}})],1)},I=[],L=n("5530"),j={name:"Detail",components:{},data:function(){return{newsInfo:[]}},computed:{time:function(){return this.$day(this.newsInfo.publishTime).format("YYYY/MM/DD HH:mm:ss")}},watch:{},methods:{back:function(){this.$router.go(-1)},handleStar:function(){this.newsInfo.star++,console.log(this.newsInfo.star),this.$axios.patch("/news/".concat(this.$route.params.id),{star:this.newsInfo.star})}},created:function(){var e=this;this.$axios.get("/news/".concat(this.$route.params.id,"?_expand=category&_expand=role")).then((function(t){return e.newsInfo=Object(L["a"])(Object(L["a"])({},t.data),{},{view:t.data.view+1}),t.data})).then((function(t){e.$axios.patch("/news/".concat(e.$route.params.id),{view:t.view+1})}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},P=j,E=(n("f00a"),Object(f["a"])(P,O,I,!1,null,"80a798c0",null)),D=E.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"100vh"}},[n("el-aside",{attrs:{width:"auto"}},[n("Menu")],1),n("el-container",[n("el-header",[n("TopHeader")],1),n("el-main",[n("NewsRouter")],1)],1)],1)},U=[],M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activePath,collapse:e.isCollapse,"unique-opened":!0,"background-color":"#001529","text-color":"#FFFFFF","active-text-color":"#6284FF",router:!0},on:{open:e.handleOpen,close:e.handleClose}},[n("h3",{staticClass:"title"},[e._v(e._s(e.isCollapse?"管理":"全球新闻发布管理系统"))]),e._l(e.noChildren,(function(t){return n("el-menu-item",{key:t.id,attrs:{index:t.key},on:{click:function(n){return e.saveNavState(t.key)}}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])})),e._l(e.haveChildren,(function(t){return n("el-submenu",{key:t.id,attrs:{index:t.key}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-warning"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]),e._l(t.children,(function(t){return[1===t.pagepermisson?n("el-menu-item",{key:t.id,attrs:{index:t.key},on:{click:function(n){return e.saveNavState(t.key)}}},[n("i",{staticClass:"el-icon-warning"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]):e._e()]}))],2)}))],2)},A=[],T=(n("4de4"),n("d3b7"),n("2f62")),z={name:"Menu",data:function(){return{rights:[],activePath:"/home"}},watch:{},computed:Object(L["a"])({noChildren:function(){return this.rights.filter((function(e){return 0==e.children.length}))},haveChildren:function(){return this.rights.filter((function(e){return 0==!e.children.length}))}},Object(T["c"])(["isCollapse"])),methods:{handleOpen:function(e,t){console.log(e,t)},handleClose:function(e,t){console.log(e,t)},saveNavState:function(e){window.sessionStorage.setItem("activePath",e)}},created:function(){var e=this;this.$axios.get("/rights?_embed=children").then((function(t){e.rights=t.data})),this.activePath=window.sessionStorage.getItem("activePath")},mounted:function(){}},R=z,B=(n("a27f"),Object(f["a"])(R,M,A,!1,null,"af848f30",null)),q=B.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"topHeader"},[n("i",{directives:[{name:"show",rawName:"v-show",value:1==e.isCollapse,expression:"isCollapse == true"}],staticClass:"el-icon-s-unfold fold",on:{click:e.OPEN}}),n("i",{directives:[{name:"show",rawName:"v-show",value:0==e.isCollapse,expression:"isCollapse == false"}],staticClass:"el-icon-s-fold fold",on:{click:e.OPEN}}),n("div",{staticClass:"right"},[n("span",[e._v("欢迎 "),n("span",{staticStyle:{color:"#1890ff"}},[e._v(e._s(e.username))]),e._v(" 回来")]),n("div",{staticClass:"headPortrait"},[n("el-dropdown",{attrs:{"hide-on-click":!1,placement:"bottom"},on:{command:e.withdraw}},[n("el-avatar",{attrs:{size:e.size,src:e.circleUrl}}),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[e._v(e._s(e.roleName))]),n("el-dropdown-item",{attrs:{command:""}},[e._v("退出")])],1)],1)],1)])])},J=[],V={name:"TopHeader",components:{},data:function(){return{circleUrl:"https://s1.ax1x.com/2022/06/13/XfE6xI.jpg",size:30}},computed:Object(L["a"])(Object(L["a"])({},Object(T["c"])(["isCollapse"])),{},{username:function(){return JSON.parse(localStorage.getItem("token")).username},roleName:function(){return JSON.parse(localStorage.getItem("token")).role.roleName}}),watch:{},methods:Object(L["a"])({withdraw:function(){localStorage.removeItem("token"),this.$router.push("/login")}},Object(T["b"])(["OPEN"])),created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Y=V,K=(n("d1a7"),Object(f["a"])(Y,H,J,!1,null,"5b774059",null)),X=K.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},W=[],Q={name:"NewsRouter",components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Z=Q,ee=(n("f635"),Object(f["a"])(Z,G,W,!1,null,"5a329aa0",null)),te=ee.exports,ne={name:"Main",components:{Menu:q,TopHeader:X,NewsRouter:te},methods:{},mounted:function(){}},re=ne,ae=(n("011c"),Object(f["a"])(re,N,U,!1,null,"7e75e96a",null)),oe=ae.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("el-row",{staticClass:"row-bg",attrs:{type:"flex",gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("用户最常浏览")])]),e._l(e.viewList,(function(t){return n("div",{key:t.id,staticClass:"text"},[n("router-link",{attrs:{to:"/news-manage/preview/"+t.id}},[e._v(e._s(t.title))])],1)}))],2)],1),n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("用户点赞最多")])]),e._l(e.starList,(function(t){return n("div",{key:t.id,staticClass:"text"},[n("router-link",{attrs:{to:"/news-manage/preview/"+t.id}},[e._v(e._s(t.title))])],1)}))],2)],1),n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("el-image",{staticStyle:{width:"100%"},attrs:{src:"https://gw.alipayobjects.com/zos/rmsportal/JiqGstEfoWAOHiTxclqi.png",fit:"contain"}})],1),n("div",{staticClass:"box"},[n("el-avatar",{staticClass:"img",attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}}),n("div",{staticClass:"text"},[n("h4",[e._v("admin")]),n("p",[e._v("全球"),n("span",[e._v("超级管理员")])])])],1),n("el-divider"),n("el-row",{staticClass:"row-bg row-margin-t",attrs:{gutter:20,type:"flex"}},[n("el-col",{attrs:{span:8}},[n("div",{staticClass:"t-icon"},[n("i",{staticClass:"el-icon-s-tools icon-style",on:{click:e.rightbox}})])]),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"t-icon"},[n("i",{staticClass:"el-icon-edit icon-style"})])]),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"t-icon"},[n("i",{staticClass:"el-icon-share icon-style"})])])],1)],1)],1)],1),n("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"main"}}),n("el-drawer",{attrs:{title:"个人新闻分类",visible:e.drawer,direction:e.direction,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[n("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"main-pre"}})])],1)},se=[],le=(n("b64b"),n("d81d"),n("07ac"),{components:{},data:function(){return{viewList:[],starList:[],drawer:!1,direction:"rtl",allList:[],pieChart:null}},computed:{},watch:{},methods:{rightbox:function(){var e=this;setTimeout((function(){e.renderPieView()}),0),this.drawer=!0},renderPieView:function(){var e,t,n=JSON.parse(localStorage.getItem("token")),r=n.username,a=this.allList.filter((function(e){return e.author===r})),o=this._.groupBy(a,(function(e){return e.category.title})),i=[];for(var s in o)i.push({name:s,value:o[s].length});this.pieChart?e=this.pieChart:(e=this.$echarts.init(document.getElementById("main-pre")),this.pieChart=e),t={title:{text:"当前用户新闻分类图示",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"发布数量",type:"pie",radius:"50%",data:i,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},t&&e.setOption(t)},drawLine:function(e){var t=this.$echarts.init(document.getElementById("main"));t.setOption({title:{text:"新闻分类图示"},tooltip:{},legend:{data:["数量"]},xAxis:{data:Object.keys(e),axisLabel:{rotate:"45",interval:0}},yAxis:{minInterval:1},series:[{name:"数量",type:"bar",data:Object.values(e).map((function(e){return e.length}))}]})},handleClose:function(){this.drawer=!1}},created:function(){var e=this;this.$axios.get("/news?publishState=2&_expand=category&_sort=view&_order=desc&_limit=6").then((function(t){e.viewList=t.data})),this.$axios.get("/news?publishState=2&_expand=category&_sort=star&_order=desc&_limit=6").then((function(t){e.starList=t.data})),this.$axios.get("/news?publishState=2&_expand=category").then((function(t){e.drawLine(e._.groupBy(t.data,(function(e){return e.category.title}))),e.allList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),ce=le,ue=(n("1f2b"),Object(f["a"])(ce,ie,se,!1,null,"d9d9351e",null)),de=ue.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("添加用户")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"region",label:"区域",width:"180"}}),n("el-table-column",{attrs:{prop:"role.roleName",label:"角色名称",width:"180"}}),n("el-table-column",{attrs:{prop:"username",label:"用户名"}}),n("el-table-column",{attrs:{label:"用户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{disabled:t.row.default,value:t.row.roleState},on:{change:function(n){return e.roleState(t.row)}}})]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleDelete(t.row)}}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleEdit(t.row)}}})]}}])})],1),n("el-pagination",{attrs:{align:"center",background:"","current-page":e.currentPage,"page-sizes":[5],"page-size":e.pageSize,layout:" prev, pager, next",total:e.tableData.length},on:{"current-change":e.handleCurrentChange}}),n("el-dialog",{attrs:{title:"add"==e.title?"添加用户":"编辑用户",visible:e.isAddvisible,width:"30%"},on:{"update:visible":function(t){e.isAddvisible=t}}},[n("span",[n("UserForm",{ref:"addFrom",attrs:{roleList:e.roleList,regionList:e.regionList,ruleForm:e.ruleForm}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancel}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)])],1)},me=[],he=n("2909"),pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"UserForm"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,size:"small","label-width":"100px","label-position":"top"}},[n("el-form-item",{attrs:{label:"用户名",prop:"username"}},[n("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),n("el-form-item",{attrs:{label:"区域",prop:"region"}},[n("el-select",{attrs:{disabled:e.disabled},model:{value:e.ruleForm.region,callback:function(t){e.$set(e.ruleForm,"region",t)},expression:"ruleForm.region"}},e._l(e.regionList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.value}})})),1)],1),n("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[n("el-select",{on:{change:e.refresh},model:{value:e.ruleForm.roleId,callback:function(t){e.$set(e.ruleForm,"roleId",t)},expression:"ruleForm.roleId"}},e._l(e.roleList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.roleName,value:e.roleType}})})),1)],1)],1)],1)},be=[],ge={components:{},props:["roleList","regionList","ruleForm"],data:function(){return{disabled:!1,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:12,message:"长度在 3 到 12 个字符",trigger:"blur"}],region:[{required:!1,message:"请选择区域",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}]}}},computed:{},watch:{},methods:{refresh:function(){1===this.ruleForm.roleId?(this.disabled=!0,this.ruleForm.region=""):this.disabled=!1}},created:function(){var e=this;setInterval((function(){e.refresh()}),0)},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},ve=ge,we=(n("8854"),Object(f["a"])(ve,pe,be,!1,null,"ebd84486",null)),ye=we.exports,_e={name:"UserList",components:{UserForm:ye},data:function(){return{region:{},userList:[],regionList:[],roleList:[],isAddvisible:!1,ruleForm:{username:"",password:"",region:"",roleId:""},currentPage:1,pageSize:5,title:"add"}},computed:{tableData:function(){for(var e=this.userList,t=0;t<e.length;t++)""===e[t].region&&(e[t].region="全球");return e}},watch:{},methods:{addUser:function(){this.title="add",this.isAddvisible=!0},confirm:function(){var e=this;"add"===this.title?this.$refs.addFrom.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$axios.post("/users",Object(L["a"])(Object(L["a"])({},e.ruleForm),{},{roleState:!0,default:!1})).then((function(t){e.userList=[].concat(Object(he["a"])(e.userList),[Object(L["a"])(Object(L["a"])({},t.data),{},{role:e.roleList.filter((function(t){return t.id===e.ruleForm.roleId}))[0]})]),e.ruleForm={username:"",password:"",region:"",roleId:""}}))})):this.$refs.addFrom.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$axios.patch("/users/".concat(e.ruleForm.id),Object(L["a"])({},e.ruleForm)).then((function(){e.getUserList(),e.ruleForm={username:"",password:"",region:"",roleId:""}}))})),this.isAddvisible=!1},cancel:function(){this.isAddvisible=!1,this.ruleForm={username:"",password:"",region:"",roleId:""},this.disabled=!1},roleState:function(e){e.roleState=!e.roleState,this.$axios.patch("/users/".concat(e.id),{roleState:e.roleState})},handleEdit:function(e){this.isAddvisible=!0,this.title="edit",this.ruleForm.username=e.username,this.ruleForm.password=e.password,this.ruleForm.region=e.region,this.ruleForm.roleId=e.roleId,this.ruleForm.roleState=e.roleState,this.ruleForm.default=e.default,this.ruleForm.id=e.id},handleDelete:function(e){var t=this;this.$confirm("将删除该用户, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.userList=t.userList.filter((function(t){return t.id!==e.id})),t.$axios.delete("/users/".concat(e.id))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleCurrentChange:function(e){this.currentPage=e},getUserList:function(){var e=this,t={1:"superadmin",2:"admin",3:"editor"},n=JSON.parse(localStorage.getItem("token")),r=n.roleId,a=n.region,o=n.username;this.$axios.get("/users?_expand=role").then((function(n){var i=n.data;e.userList="superadmin"===t[r]?i:[].concat(Object(he["a"])(i.filter((function(e){return e.username===o}))),Object(he["a"])(i.filter((function(t){return t.region===a&&"editor"===e.roleObj[t.roleId]}))))}))}},created:function(){var e=this;this.getUserList(),this.$axios.get("/regions").then((function(t){e.regionList=t.data})),this.$axios.get("/roles").then((function(t){e.roleList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},xe=_e,Ce=(n("39ec"),Object(f["a"])(xe,fe,me,!1,null,"3d46cba0",null)),ke=Ce.exports,Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"rightList"},[e._v("RightList")])},Se=[],$e={components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Oe=$e,Ie=(n("1912"),Object(f["a"])(Oe,Fe,Se,!1,null,"7dfba9f9",null)),Le=Ie.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"roleList"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"300"}}),n("el-table-column",{attrs:{prop:"roleName",label:"角色名称",width:"300"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleDelete(t.row)}}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-more",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleEdit(t.row,e.rightList)}}})]}}])})],1),n("el-dialog",{attrs:{title:"权限分配",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-tree",{ref:"tree",attrs:{props:e.props,data:e.rightList,"show-checkbox":"",accordion:"","check-strictly":"","node-key":"key","default-checked-keys":e.currentRights}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v("确 定")])],1)],1)],1)},Pe=[],Ee={components:{},data:function(){return{dialogVisible:!1,dataSource:[],rightList:[],props:{label:"title",children:"children"},currentRights:[],currentId:0}},computed:{tableData:function(){return this.dataSource}},watch:{},methods:{handleDelete:function(e){var t=this;console.log(e),this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message({type:"success",message:"删除成功!"}),t.$axios.delete("/roles/".concat(e.id)),t.dataSource=t.dataSource.filter((function(t){return t.id!==e.id}))}))},handleEdit:function(e){this.dialogVisible=!0,this.currentId=e.id,this.currentRights=e.rights},handleOk:function(){this.dialogVisible=!1,this.resetChecked()},handleCancel:function(){this.dialogVisible=!1},resetChecked:function(){var e=this;this.currentRights=this.$refs.tree.getCheckedKeys(!1),this.$axios.patch("/roles/".concat(this.currentId),{rights:this.currentRights}),this.currentRights=[],this.$refs.tree.setCheckedKeys([]),setTimeout((function(){e.getDataSource()}),10)},getDataSource:function(){var e=this;this.$axios.get("/roles").then((function(t){e.dataSource=t.data}))}},created:function(){var e=this;this.getDataSource(),this.$axios.get("/rights?_embed=children").then((function(t){e.rightList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},De=Ee,Ne=(n("c84a"),Object(f["a"])(De,je,Pe,!1,null,"1c1f7fdb",null)),Ue=Ne.exports;s["default"].use(p["a"]);var Me=[{path:"/login",name:"Login",component:_},{path:"/news",name:"News",component:$},{path:"/detail/:id",name:"Detail",component:D},{path:"*",name:"Main",component:oe,meta:{isAuth:!0},children:[{path:"/home",name:"Home",component:de,meta:{isAuth:!0}},{path:"/user-manage/list",name:"UserList",component:ke,meta:{isAuth:!0}},{path:"/right-manage/role/list",name:"RoleList",component:Ue,meta:{isAuth:!0}},{path:"/right-manage/right/list",name:"RightList",component:Le,meta:{isAuth:!0}}]}],Ae=new p["a"]({mode:"history",base:"/vue/",routes:Me});Ae.beforeEach((function(e,t,n){"/"==e.path&&(window.sessionStorage.setItem("activePath","/home"),n({path:"/home"})),e.meta.isAuth?localStorage.getItem("token")?n():n({path:"/login"}):n()}));var Te=Ae;s["default"].use(T["a"]);var ze=new T["a"].Store({state:{isCollapse:!1},mutations:{OPEN:function(e){e.isCollapse=!e.isCollapse}},actions:{},modules:{}}),Re=n("5c96"),Be=n.n(Re),qe=(n("0fae"),n("bc3a")),He=n.n(qe),Je=(n("840a"),n("98c9")),Ve=n("313e"),Ye=n("2ef0"),Ke=n.n(Ye);He.a.defaults.baseURL="http://101.43.137.36:2246";var Xe=n("5a0c"),Ge=n.n(Xe);s["default"].prototype.$axios=He.a,s["default"].use(r["b"]).use(a["a"]).use(o["a"]).use(i["a"]),s["default"].prototype.$day=Ge.a,s["default"].prototype._=Ke.a,s["default"].prototype.$echarts=Ve,s["default"].use(Je["a"]),s["default"].config.productionTip=!1,s["default"].use(Be.a),new s["default"]({router:Te,store:ze,render:function(e){return e(h)}}).$mount("#app")},"738f":function(e,t,n){},7454:function(e,t,n){},"85ec":function(e,t,n){},8854:function(e,t,n){"use strict";n("bfaa")},"8b30":function(e,t,n){},a27f:function(e,t,n){"use strict";n("e6a7")},bfaa:function(e,t,n){},c4db:function(e,t,n){},c84a:function(e,t,n){"use strict";n("2796")},d1a7:function(e,t,n){"use strict";n("fb6a")},e6a7:function(e,t,n){},f00a:function(e,t,n){"use strict";n("4dc9")},f635:function(e,t,n){"use strict";n("342e")},fb6a:function(e,t,n){}});
//# sourceMappingURL=app.78dff0fd.js.map