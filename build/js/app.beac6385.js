(function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/vue/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"011c":function(e,t,n){"use strict";n("738f")},"034f":function(e,t,n){"use strict";n("85ec")},"0898":function(e,t,n){},"09b8":function(e,t,n){},"0ceb":function(e,t,n){},1589:function(e,t,n){"use strict";n("62bc")},1702:function(e,t,n){},"176e":function(e,t,n){},"178c":function(e,t,n){},"1f2b":function(e,t,n){"use strict";n("c4db")},"241d":function(e,t,n){"use strict";n("5891")},2778:function(e,t,n){"use strict";n("e152")},"27f4":function(e,t,n){"use strict";n("0ceb")},3181:function(e,t,n){},"342e":function(e,t,n){},"369c":function(e,t,n){"use strict";n("178c")},"36dd":function(e,t,n){"use strict";n("6d26")},"3d76":function(e,t,n){"use strict";n("cce2")},4992:function(e,t,n){},"4b40":function(e,t,n){"use strict";n("3181")},"4dc9":function(e,t,n){},5264:function(e,t,n){"use strict";n("176e")},5539:function(e,t,n){"use strict";n("0898")},"56d7":function(e,t,n){"use strict";n.r(t);n("06ea");var r=n("fe2b"),a=(n("0ece"),n("27fd")),i=(n("9b09"),n("6634")),o=(n("c0ed"),n("9fd0")),s=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},l=[],u={name:"APP"},d=u,f=(n("034f"),n("2877")),p=Object(f["a"])(d,c,l,!1,null,null,null),h=p.exports,m=n("8c4f"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("vue-particles",{attrs:{color:"#dedede"}}),n("div",{staticClass:"formContainer"},[n("h3",{staticClass:"lpogintitle"},[e._v("用户登录")]),n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"用户名",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")]),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("注册")])],1)],1)],1)],1)},b=[],v=(n("99af"),n("b0c0"),n("e9c4"),{name:"Login",components:{},data:function(){return{ruleForm:{name:"",password:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:12,message:"长度在 3 到 12 个字符",trigger:"blur"}]}}},computed:{},watch:{},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("请输入所有字段"),!1;t.$axios.get("/users?username=".concat(t.ruleForm.name,"&password=").concat(t.ruleForm.password,"&roleState=true&_expand=role")).then((function(e){0===e.data.length?t.$message.error("用户名或密码不匹配"):(localStorage.setItem("token",JSON.stringify(e.data[0])),t.$router.push("/home"))}))}))},resetForm:function(e){this.$refs[e].resetFields()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),w=v,y=(n("2778"),Object(f["a"])(w,g,b,!1,null,"84a649a4",null)),S=y.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"news"},[e._m(0),n("el-row",{attrs:{gutter:32}},e._l(e.list,(function(t){return n("el-col",{key:t.id,staticClass:"box",attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v(e._s(t[0]))])]),n("a-list",{attrs:{"item-layout":"vertical",size:"large",pagination:e.pagination,"data-source":t[1]},scopedSlots:e._u([{key:"renderItem",fn:function(t){return n("a-list-item",{key:"item.title"},[n("a-list-item-meta",{attrs:{description:t.description}},[n("router-link",{attrs:{slot:"title",to:"/detail/"+t.id},slot:"title"},[e._v(" "+e._s(t.title))])],1)],1)}}],null,!0)})],1)],1)})),1)],1)},x=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("h3",[e._v("全球大新闻")]),n("span",[e._v("查看新闻")])])}],C=(n("4fad"),{name:"News",components:{},data:function(){return{list:[],pagination:{pageSize:3}}},computed:{},watch:{},methods:{handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this;this.$axios.get("/news?publishState=2&_expand=category").then((function(t){var n=Object.entries(e._.groupBy(t.data,(function(e){return e.category.title})));e.list=n}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),$=C,k=(n("5264"),Object(f["a"])($,_,x,!1,null,"e955661e",null)),I=k.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail"},[e.newsInfo.title&&e.newsInfo.category.title?n("a-page-header",{attrs:{title:e.newsInfo.title,"sub-title":e.newsInfo.category.title},on:{back:e.back}}):e._e(),n("a-descriptions",{staticStyle:{padding:"0 24px"},attrs:{size:"small"}},[n("a-descriptions-item",{attrs:{label:"发布者"}},[e._v(e._s(e.newsInfo.author)+" ")]),n("a-descriptions-item",{attrs:{label:"发布时间"}},[e._v(" "+e._s(e.time)+" ")]),n("a-descriptions-item",{attrs:{label:"区域"}},[e._v(" "+e._s(e.newsInfo.region)+" ")]),n("a-descriptions-item",{attrs:{label:"访问数量"}},[e._v(" "+e._s(e.newsInfo.view)+" ")]),n("a-descriptions-item",{attrs:{label:"点赞数量"}},[e._v(" "+e._s(e.newsInfo.star)+" "),n("i",{staticClass:"el-icon-thumb",staticStyle:{color:"red","margin-left":"20px"},on:{click:e.handleStar}})]),n("a-descriptions-item",{attrs:{label:"评论数量"}},[e._v(" 0 ")])],1),n("div",{staticStyle:{margin:"0 24px",border:"1px solid gray"},domProps:{innerHTML:e._s(e.newsInfo.content)}})],1)},O=[],P=n("5530"),L={name:"Detail",components:{},data:function(){return{newsInfo:[]}},computed:{time:function(){return this.$day(this.newsInfo.publishTime).format("YYYY/MM/DD HH:mm:ss")}},watch:{},methods:{back:function(){this.$router.go(-1)},handleStar:function(){this.newsInfo.star++,console.log(this.newsInfo.star),this.$axios.patch("/news/".concat(this.$route.params.id),{star:this.newsInfo.star})}},created:function(){var e=this;this.$axios.get("/news/".concat(this.$route.params.id,"?_expand=category&_expand=role")).then((function(t){return e.newsInfo=Object(P["a"])(Object(P["a"])({},t.data),{},{view:t.data.view+1}),t.data})).then((function(t){e.$axios.patch("/news/".concat(e.$route.params.id),{view:t.view+1})}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},j=L,N=(n("f00a"),Object(f["a"])(j,F,O,!1,null,"80a798c0",null)),D=N.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"100vh"}},[n("el-aside",{attrs:{width:"auto"}},[n("Menu")],1),n("el-container",[n("el-header",[n("TopHeader")],1),n("el-main",[n("NewsRouter")],1)],1)],1)},A=[],E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activePath,collapse:e.isCollapse,"unique-opened":!0,"background-color":"#001529","text-color":"#FFFFFF","active-text-color":"#6284FF",router:!0}},[n("h3",{staticClass:"title"},[e._v(e._s(e.isCollapse?"管理":"全球新闻发布管理系统"))]),e._l(e.noChildren,(function(t){return[1===t.pagepermisson&&e.rights.includes(t.key)?n("el-menu-item",{key:t.id,attrs:{index:t.key},on:{click:function(n){return e.SetActive(t.key)}}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]):e._e()]})),e._l(e.haveChildren,(function(t){return[1===t.pagepermisson&&e.rights.includes(t.key)?n("el-submenu",{key:t.id,attrs:{index:t.key}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-warning"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]),e._l(t.children,(function(t){return[1===t.pagepermisson&&e.rights.includes(t.key)?n("el-menu-item",{key:t.id,attrs:{index:t.key},on:{click:function(n){return e.SetActive(t.key)}}},[n("i",{staticClass:"el-icon-warning"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]):e._e()]}))],2):e._e()]}))],2)},U=[],M=(n("4de4"),n("d3b7"),n("2f62")),T={name:"Menu",data:function(){return{menu:[],rights:JSON.parse(localStorage.getItem("token")).role.rights}},watch:{},computed:Object(P["a"])({noChildren:function(){return this.menu.filter((function(e){return 0==e.children.length}))},haveChildren:function(){return this.menu.filter((function(e){return 0==!e.children.length}))}},Object(M["c"])(["isCollapse","activePath"])),methods:Object(P["a"])({},Object(M["b"])(["SetActive"])),created:function(){var e=this;this.$axios.get("/rights?_embed=children").then((function(t){e.menu=t.data}))},mounted:function(){}},R=T,B=(n("fb13"),Object(f["a"])(R,E,U,!1,null,"4184e7fb",null)),J=B.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"topHeader"},[n("i",{directives:[{name:"show",rawName:"v-show",value:1==e.isCollapse,expression:"isCollapse == true"}],staticClass:"el-icon-s-unfold fold",on:{click:e.OPEN}}),n("i",{directives:[{name:"show",rawName:"v-show",value:0==e.isCollapse,expression:"isCollapse == false"}],staticClass:"el-icon-s-fold fold",on:{click:e.OPEN}}),n("div",{staticClass:"right"},[n("span",[e._v("欢迎 "),n("span",{staticStyle:{color:"#1890ff"}},[e._v(e._s(e.username))]),e._v(" 回来")]),n("div",{staticClass:"headPortrait"},[n("el-dropdown",{attrs:{"hide-on-click":!1,placement:"bottom"}},[n("el-avatar",{attrs:{size:e.size,src:e.circleUrl}}),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[e._v(e._s(e.roleName))]),n("el-dropdown-item",{nativeOn:{click:function(t){return e.withdraw.apply(null,arguments)}}},[e._v("退出")])],1)],1)],1)])])},H=[],V={name:"TopHeader",components:{},data:function(){return{circleUrl:"https://s1.ax1x.com/2022/06/13/XfE6xI.jpg",size:30}},computed:Object(P["a"])(Object(P["a"])({},Object(M["c"])(["isCollapse"])),{},{username:function(){return JSON.parse(localStorage.getItem("token")).username},roleName:function(){return JSON.parse(localStorage.getItem("token")).role.roleName}}),watch:{},methods:Object(P["a"])({withdraw:function(){localStorage.removeItem("token"),this.$store.commit("ClearActive"),this.$store.commit("ClearIsCollapse"),this.$router.push("/login")}},Object(M["b"])(["OPEN"])),created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Y=V,K=(n("dcb4"),Object(f["a"])(Y,q,H,!1,null,"12a32787",null)),X=K.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},W=[],Q={name:"NewsRouter",components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Z=Q,ee=(n("f635"),Object(f["a"])(Z,G,W,!1,null,"5a329aa0",null)),te=ee.exports,ne={name:"Main",components:{Menu:J,TopHeader:X,NewsRouter:te},methods:{},mounted:function(){}},re=ne,ae=(n("011c"),Object(f["a"])(re,z,A,!1,null,"7e75e96a",null)),ie=ae.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("el-row",{staticClass:"row-bg",attrs:{type:"flex",gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("用户最常浏览")])]),e._l(e.viewList,(function(t){return n("div",{key:t.id,staticClass:"text"},[n("router-link",{attrs:{to:"/news-manage/preview/"+t.id}},[e._v(e._s(t.title))])],1)}))],2)],1),n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("用户点赞最多")])]),e._l(e.starList,(function(t){return n("div",{key:t.id,staticClass:"text"},[n("router-link",{attrs:{to:"/news-manage/preview/"+t.id}},[e._v(e._s(t.title))])],1)}))],2)],1),n("el-col",{attrs:{span:8}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("el-image",{staticStyle:{width:"100%"},attrs:{src:"https://gw.alipayobjects.com/zos/rmsportal/JiqGstEfoWAOHiTxclqi.png",fit:"contain"}})],1),n("div",{staticClass:"box"},[n("el-avatar",{staticClass:"img",attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}}),n("div",{staticClass:"text"},[n("h4",[e._v("admin")]),n("p",[e._v("全球"),n("span",[e._v("超级管理员")])])])],1),n("el-divider"),n("el-row",{staticClass:"row-bg row-margin-t",attrs:{gutter:20,type:"flex"}},[n("el-col",{attrs:{span:8}},[n("div",{staticClass:"t-icon"},[n("i",{staticClass:"el-icon-s-tools icon-style",on:{click:e.rightbox}})])]),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"t-icon"},[n("i",{staticClass:"el-icon-edit icon-style"})])]),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"t-icon"},[n("i",{staticClass:"el-icon-share icon-style"})])])],1)],1)],1)],1),n("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"main"}}),n("el-drawer",{attrs:{title:"个人新闻分类",visible:e.drawer,direction:e.direction,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[n("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"main-pre"}})])],1)},se=[],ce=(n("b64b"),n("d81d"),n("07ac"),{components:{},data:function(){return{viewList:[],starList:[],drawer:!1,direction:"rtl",allList:[],pieChart:null}},computed:{},watch:{},methods:{rightbox:function(){var e=this;setTimeout((function(){e.renderPieView()}),0),this.drawer=!0},renderPieView:function(){var e,t,n=JSON.parse(localStorage.getItem("token")),r=n.username,a=this.allList.filter((function(e){return e.author===r})),i=this._.groupBy(a,(function(e){return e.category.title})),o=[];for(var s in i)o.push({name:s,value:i[s].length});this.pieChart?e=this.pieChart:(e=this.$echarts.init(document.getElementById("main-pre")),this.pieChart=e),t={title:{text:"当前用户新闻分类图示",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"发布数量",type:"pie",radius:"50%",data:o,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},t&&e.setOption(t)},drawLine:function(e){var t=this.$echarts.init(document.getElementById("main"));t.setOption({title:{text:"新闻分类图示"},tooltip:{},legend:{data:["数量"]},xAxis:{data:Object.keys(e),axisLabel:{rotate:"45",interval:0}},yAxis:{minInterval:1},series:[{name:"数量",type:"bar",data:Object.values(e).map((function(e){return e.length}))}]})},handleClose:function(){this.drawer=!1}},created:function(){var e=this;this.$axios.get("/news?publishState=2&_expand=category&_sort=view&_order=desc&_limit=6").then((function(t){e.viewList=t.data})),this.$axios.get("/news?publishState=2&_expand=category&_sort=star&_order=desc&_limit=6").then((function(t){e.starList=t.data})),this.$axios.get("/news?publishState=2&_expand=category").then((function(t){e.drawLine(e._.groupBy(t.data,(function(e){return e.category.title}))),e.allList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),le=ce,ue=(n("1f2b"),Object(f["a"])(le,oe,se,!1,null,"d9d9351e",null)),de=ue.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("添加用户")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"region",label:"区域",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(""!==t.row.region?t.row.region:"全球")+" ")]}}])}),n("el-table-column",{attrs:{prop:"role.roleName",label:"角色名称",width:"180"}}),n("el-table-column",{attrs:{prop:"username",label:"用户名"}}),n("el-table-column",{attrs:{label:"用户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{disabled:t.row.default,value:t.row.roleState},on:{change:function(n){return e.roleState(t.row)}}})]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleDelete(t.row)}}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleEdit(t.row)}}})]}}])})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.userList.length},on:{"current-change":e.handleCurrentChange}}),n("el-dialog",{attrs:{title:"add"==e.title?"添加用户":"编辑用户",visible:e.isAddvisible,width:"30%"},on:{"update:visible":function(t){e.isAddvisible=t}}},[n("span",[n("UserForm",{ref:"addFrom",attrs:{roleList:e.roleList,regionList:e.regionList,ruleForm:e.ruleForm}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancel}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)])],1)},pe=[],he=n("2909"),me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"UserForm"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,size:"small","label-width":"100px","label-position":"top"}},[n("el-form-item",{attrs:{label:"用户名",prop:"username"}},[n("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),n("el-form-item",{attrs:{label:"区域",prop:"region"}},[n("el-select",{attrs:{disabled:e.isDisabled},model:{value:e.ruleForm.region,callback:function(t){e.$set(e.ruleForm,"region",t)},expression:"ruleForm.region"}},e._l(e.regionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.title,value:t.value,disabled:e.checkRegionDisabled(t)}})})),1)],1),n("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[n("el-select",{on:{change:e.refresh},model:{value:e.ruleForm.roleId,callback:function(t){e.$set(e.ruleForm,"roleId",t)},expression:"ruleForm.roleId"}},e._l(e.roleList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.roleName,value:t.roleType,disabled:e.checkRoleDisabled(t)}})})),1)],1)],1)],1)},ge=[],be={components:{},props:["roleList","regionList","ruleForm"],data:function(){return{rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:12,message:"长度在 3 到 12 个字符",trigger:"blur"}],region:this.disabled?[]:[{required:!0,message:"请选择区域",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}]},roleObj:{1:"superadmin",2:"admin",3:"editor"},isDisabled:!1}},computed:{},watch:{},methods:{checkRegionDisabled:function(e){var t=JSON.parse(localStorage.getItem("token")),n=t.roleId,r=t.region;return this.isUpdate?"superadmin"!==this.roleObj[n]:"superadmin"!==this.roleObj[n]&&e.value!==r},checkRoleDisabled:function(e){var t=JSON.parse(localStorage.getItem("token")),n=t.roleId;return this.isUpdate?"superadmin"!==this.roleObj[n]:"superadmin"!==this.roleObj[n]&&"editor"!==this.roleObj[e.id]},refresh:function(){1===this.ruleForm.roleId?(this.isDisabled=!0,this.ruleForm.region=""):this.isDisabled=!1}},created:function(){this.refresh()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){this.refresh()},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},ve=be,we=(n("5539"),Object(f["a"])(ve,me,ge,!1,null,"60b42a7d",null)),ye=we.exports,Se={name:"UserList",components:{UserForm:ye},data:function(){return{region:{},userList:[],regionList:[],roleList:[],isAddvisible:!1,ruleForm:{username:"",password:"",region:"",roleId:""},currentPage:1,pageSize:5,title:"add"}},computed:{},watch:{},methods:{addUser:function(){this.title="add",this.isAddvisible=!0},confirm:function(){var e=this;"add"===this.title?this.$refs.addFrom.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$axios.post("/users",Object(P["a"])(Object(P["a"])({},e.ruleForm),{},{roleState:!0,default:!1})).then((function(t){e.userList=[].concat(Object(he["a"])(e.userList),[Object(P["a"])(Object(P["a"])({},t.data),{},{role:e.roleList.filter((function(t){return t.id===e.ruleForm.roleId}))[0]})]),e.ruleForm={username:"",password:"",region:"",roleId:""}})),e.isAddvisible=!1})):this.$refs.addFrom.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$axios.patch("/users/".concat(e.ruleForm.id),Object(P["a"])({},e.ruleForm)).then((function(){e.getUserList(),e.ruleForm={username:"",password:"",region:"",roleId:""}})),e.isAddvisible=!1}))},cancel:function(){this.isAddvisible=!1,this.ruleForm={username:"",password:"",region:"",roleId:""},this.$refs.addFrom.$refs.ruleForm.clearValidate()},roleState:function(e){e.roleState=!e.roleState,this.$axios.patch("/users/".concat(e.id),{roleState:e.roleState})},handleEdit:function(e){this.isAddvisible=!0,this.title="edit",this.ruleForm.username=e.username,this.ruleForm.password=e.password,this.ruleForm.region=e.region,this.ruleForm.roleId=e.roleId,this.ruleForm.roleState=e.roleState,this.ruleForm.default=e.default,this.ruleForm.id=e.id},handleDelete:function(e){var t=this;this.$confirm("将删除该用户, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.userList=t.userList.filter((function(t){return t.id!==e.id})),t.$axios.delete("/users/".concat(e.id))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleCurrentChange:function(e){this.currentPage=e},getUserList:function(){var e=this,t={1:"superadmin",2:"admin",3:"editor"},n=JSON.parse(localStorage.getItem("token")),r=n.roleId,a=n.region,i=n.username;this.$axios.get("/users?_expand=role").then((function(n){var o=n.data;e.userList="superadmin"===t[r]?o:[].concat(Object(he["a"])(o.filter((function(e){return e.username===i}))),Object(he["a"])(o.filter((function(e){return e.region===a&&"editor"===t[e.roleId]}))))}))}},created:function(){var e=this;this.getUserList(),this.$axios.get("/regions").then((function(t){e.regionList=t.data})),this.$axios.get("/roles").then((function(t){e.roleList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},_e=Se,xe=(n("27f4"),Object(f["a"])(_e,fe,pe,!1,null,"c394cbd4",null)),Ce=xe.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"rightList"},[n("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"row-key":"id","indent.num":"20","tree-props":{children:"children",hasChildren:"hasChildren"}}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"180"}}),n("el-table-column",{attrs:{prop:"title",label:"权限名称",width:"180"}}),n("el-table-column",{attrs:{prop:"key",label:"权限路径"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleDelete(t.row)}}}),n("el-popover",{attrs:{placement:"top",width:"80",trigger:"click"}},[n("div",{staticStyle:{"text-align":"center",margin:"0"}},[n("p",[e._v("页面配置项")]),n("el-switch",{attrs:{value:1===t.row.pagepermisson},on:{change:function(n){return e.handleEdit(t.row,t.row.pagepermisson)}}})],1),n("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-s-operation",disabled:void 0===t.row.pagepermisson,circle:""},slot:"reference"})],1)]}}])})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},ke=[],Ie={components:{},data:function(){return{dataSource:[],currentPage:1,pageSize:5}},computed:{},watch:{},methods:{handleDelete:function(e){var t=this;this.$confirm("你确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(1===e.grade)t.dataSource=t.dataSource.filter((function(t){return t.id!==e.id})),t.$axios.delete("/rights/".concat(e.id));else{var n=t.dataSource.filter((function(t){return t.id===e.rightId}));n[0].children=n[0].children.filter((function(t){return t.id!==e.id})),t.dataSource=Object(he["a"])(t.dataSource),t.$axios.delete("/children/".concat(e.id))}t.$message({type:"success",message:"删除成功!"})}))},handleEdit:function(e){e.pagepermisson=1===e.pagepermisson?0:1,this.dataSource=Object(he["a"])(this.dataSource),1===e.grade?this.$axios.patch("/rights/".concat(e.id),{pagepermisson:e.pagepermisson}):this.$axios.patch("/children/".concat(e.id),{pagepermisson:e.pagepermisson})},handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this;this.$axios.get("/rights?_embed=children").then((function(t){e.dataSource=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Fe=Ie,Oe=(n("d743"),Object(f["a"])(Fe,$e,ke,!1,null,"7028cc62",null)),Pe=Oe.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"roleList"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"300"}}),n("el-table-column",{attrs:{prop:"roleName",label:"角色名称",width:"300"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleDelete(t.row)}}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-more",disabled:t.row.default,circle:""},on:{click:function(n){return e.handleEdit(t.row,e.rightList)}}})]}}])})],1),n("el-dialog",{attrs:{title:"权限分配",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-tree",{ref:"tree",attrs:{props:e.props,data:e.rightList,"show-checkbox":"",accordion:"","check-strictly":"","node-key":"key","default-checked-keys":e.currentRights}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v("确 定")])],1)],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},je=[],Ne={components:{},data:function(){return{dialogVisible:!1,dataSource:[],rightList:[],props:{label:"title",children:"children"},currentRights:[],currentId:0,currentPage:1,pageSize:5}},computed:{tableData:function(){return this.dataSource}},watch:{},methods:{handleDelete:function(e){var t=this;console.log(e),this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message({type:"success",message:"删除成功!"}),t.$axios.delete("/roles/".concat(e.id)),t.dataSource=t.dataSource.filter((function(t){return t.id!==e.id}))}))},handleEdit:function(e){this.dialogVisible=!0,this.currentId=e.id,this.currentRights=e.rights},handleOk:function(){this.dialogVisible=!1,this.resetChecked()},handleCancel:function(){this.dialogVisible=!1},resetChecked:function(){var e=this;this.currentRights=this.$refs.tree.getCheckedKeys(!1),this.$axios.patch("/roles/".concat(this.currentId),{rights:this.currentRights}),this.currentRights=[],this.$refs.tree.setCheckedKeys([]),setTimeout((function(){e.getDataSource()}),10)},getDataSource:function(){var e=this;this.$axios.get("/roles").then((function(t){e.dataSource=t.data}))},handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this;this.getDataSource(),this.$axios.get("/rights?_embed=children").then((function(t){e.rightList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},De=Ne,ze=(n("7295"),Object(f["a"])(De,Le,je,!1,null,"5b0b0d83",null)),Ae=ze.exports,Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"newsAdd"},[n("a-page-header",{attrs:{title:"撰写新闻",subTitle:"This is a subtitle"}}),n("el-steps",{attrs:{active:e.current,"finish-status":"success","align-center":""}},[n("el-step",{attrs:{title:"基本信息",description:"新闻标题，新闻分类"}}),n("el-step",{attrs:{title:"新闻内容",description:"新闻主体内容"}}),n("el-step",{attrs:{title:"新闻提交",description:"保存草稿或者提交审核"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current === 0"}],staticStyle:{"margin-top":"40px"}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"新闻标题",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入新闻标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),n("el-form-item",{attrs:{label:"新闻分类",prop:"categoryId"}},[n("el-select",{attrs:{placeholder:"请选择",size:"medium"},model:{value:e.ruleForm.categoryId,callback:function(t){e.$set(e.ruleForm,"categoryId",t)},expression:"ruleForm.categoryId"}},e._l(e.categoryList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current === 1"}],staticStyle:{"margin-top":"40px"}},[n("NewsEditor",{attrs:{formInline:e.formInline}})],1),n("div",[n("span",{directives:[{name:"show",rawName:"v-show",value:2===e.current,expression:"current === 2"}]},[n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){return e.handleSave(0)}}},[e._v("保存草稿箱")]),n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"success",plain:""},on:{click:function(t){return e.handleSave(1)}}},[e._v("提交审核")])],1),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.current<2,expression:"current < 2"}],staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步 ")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.current>0,expression:"current > 0"}],staticStyle:{"margin-top":"12px"},on:{click:e.handlePrevious}},[e._v("上一步")])],1)],1)},Ue=[],Me=(n("498a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("el-tiptap",{attrs:{extensions:e.extensions},model:{value:e.formInline.contentFileList,callback:function(t){e.$set(e.formInline,"contentFileList",t)},expression:"formInline.contentFileList"}})],1)}),Te=[],Re=n("4ccc"),Be={components:{},props:{formInline:Object},data:function(){return{extensions:[new Re["d"],new Re["s"],new Re["m"],new Re["f"]({level:5}),new Re["b"]({bubble:!0}),new Re["v"]({bubble:!0,menubar:!1}),new Re["j"],new Re["n"],new Re["k"],new Re["c"],new Re["l"],new Re["h"],new Re["a"],new Re["t"],new Re["i"],new Re["o"],new Re["q"],new Re["p"],new Re["r"],new Re["g"],new Re["u"]]}},methods:{}},Je=Be,qe=Object(f["a"])(Je,Me,Te,!1,null,"502c5788",null),He=qe.exports,Ve={components:{NewsEditor:He},data:function(){return{current:0,categoryList:[],ruleForm:{},rules:{title:[{required:!0,message:"请输入新闻标题",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类",trigger:"blur"}]},formInline:{contentFileList:""}}},computed:{},watch:{},methods:{handlePrevious:function(){this.current=this.current-1,console.log(this.current)},handleNext:function(){var e=this;0===this.current?this.$refs.ruleForm.validate((function(t){t&&(console.log(e.ruleForm),e.current=e.current+1)})):""===this.formInline.contentFileList||"<p></p>"===this.formInline.contentFileList.trim()?this.$message.error("新闻内容不能为空"):(console.log(this.formInline.contentFileList),this.current=this.current+1)},handleSave:function(e){var t=this;console.log(e);var n=JSON.parse(localStorage.getItem("token"));this.$axios.post("/news",Object(P["a"])(Object(P["a"])({},this.ruleForm),{},{content:this.formInline.contentFileList,region:n.region?n.region:"全球",author:n.username,roleId:n.roleId,auditState:e,publishState:0,createTime:Date.now(),star:0,view:0})).then((function(){t.$router.push(0===e?"/news-manage/draft":"/audit-manage/list"),t.$notify({title:"通知",message:"您可以到".concat(0===e?"草稿箱":"审核列表","中查看您的新闻"),position:"bottom-right",type:"success"}),t.$store.commit("SetActive",0===e?"/news-manage/draft":"/audit-manage/list")}))}},created:function(){var e=this;this.$axios.get("/categories").then((function(t){e.categoryList=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Ye=Ve,Ke=(n("369c"),Object(f["a"])(Ye,Ee,Ue,!1,null,"14262d6a",null)),Xe=Ke.exports,Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"newsCategory"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"150"}}),n("el-table-column",{attrs:{prop:"title",label:"栏目名称"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDelete(t.row)}}})]}}])})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},We=[],Qe={components:{},data:function(){return{dataSource:[],currentPage:1,pageSize:5}},computed:{},watch:{},methods:{handleDelete:function(e){var t=this;this.$confirm("你确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.dataSource=t.dataSource.filter((function(t){return t.id!==e.id})),t.$axios.delete("/categories/".concat(e.id))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this;this.$axios.get("/categories").then((function(t){e.dataSource=t.data,console.log(e.dataSource)}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Ze=Qe,et=(n("36dd"),Object(f["a"])(Ze,Ge,We,!1,null,"8eca13a0",null)),tt=et.exports,nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"newsDraft"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"150"}}),n("el-table-column",{attrs:{prop:"title",label:"新闻标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:"/news-manage/preview/"+t.row.id}},[e._v(e._s(t.row.title))])]}}])}),n("el-table-column",{attrs:{prop:"author",label:"作者"}}),n("el-table-column",{attrs:{prop:"category.title",label:"分类"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDelete(t.row)}}}),n("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(n){return e.handleEdit(t.row)}},slot:"reference"}),n("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-upload",circle:""},on:{click:function(n){return e.handleCheck(t.row)}},slot:"reference"})]}}])})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},rt=[],at={components:{},data:function(){return{dataSource:[],currentPage:1,pageSize:5}},computed:{},watch:{},methods:{handleDelete:function(e){var t=this;this.$confirm("你确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.dataSource=t.dataSource.filter((function(t){return t.id!==e.id})),t.$axios.delete("/news/".concat(e.id))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleEdit:function(e){this.$router.push("/news-manage/update/".concat(e.id)),this.$store.commit("SetActive","/news-manage/update/".concat(e.id))},handleCheck:function(e){var t=this;this.$axios.patch("/news/".concat(e.id),{auditState:1}).then((function(){t.$router.push("/audit-manage/list"),t.$notify({title:"通知",message:"您可以到".concat("审核列表","中查看您的新闻"),position:"bottom-right",type:"success"}),t.$store.commit("SetActive","/audit-manage/list")}))},handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this,t=JSON.parse(localStorage.getItem("token")),n=t.username;this.$axios.get("/news?author=".concat(n,"&auditState=0&_expand=category")).then((function(t){e.dataSource=t.data,console.log(e.dataSource)}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},it=at,ot=(n("1589"),Object(f["a"])(it,nt,rt,!1,null,"a4030150",null)),st=ot.exports,ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"Audit"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"title",label:"新闻标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:"/news-manage/preview/"+t.row.id}},[e._v(e._s(t.row.title))])]}}])}),n("el-table-column",{attrs:{prop:"author",label:"作者",width:"180"}}),n("el-table-column",{attrs:{prop:"category.title",label:"新闻分类"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.handleAudit(t.row,2,1)}}},[e._v("通过")]),n("el-button",{attrs:{type:"danger",plain:""},on:{click:function(n){return e.handleAudit(t.row,3,0)}}},[e._v("驳回")])]}}])})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},lt=[],ut={components:{},data:function(){return{dataSource:[],currentPage:1,pageSize:5}},computed:{},watch:{},methods:{handleAudit:function(e,t,n){var r=this;this.dataSource=this.dataSource.filter((function(t){return t.id!==e.id})),this.$axios.patch("/news/".concat(e.id),{auditState:t,publishState:n}).then((function(){r.$notify({title:"通知",message:"您可以到[审核管理/审核列表]中查看您的新闻的审核状态",position:"bottom-right",type:"success"})}))},handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this,t=JSON.parse(localStorage.getItem("token")),n=t.roleId,r=t.region,a=t.username,i={1:"superadmin",2:"admin",3:"editor"};this.$axios.get("/news?auditState=1&_expand=category").then((function(t){var o=t.data;e.dataSource="superadmin"===i[n]?o:[].concat(Object(he["a"])(o.filter((function(e){return e.author===a}))),Object(he["a"])(o.filter((function(e){return e.region===r&&"editor"===i[e.roleId]}))))}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},dt=ut,ft=(n("ec52"),Object(f["a"])(dt,ct,lt,!1,null,"303f7e25",null)),pt=ft.exports,ht=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"AuditList"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"title",label:"新闻标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:"/news-manage/preview/"+t.row.id}},[e._v(e._s(t.row.title))])]}}])}),n("el-table-column",{attrs:{prop:"author",label:"作者",width:"180"}}),n("el-table-column",{attrs:{prop:"category.title",label:"新闻分类"}}),n("el-table-column",{attrs:{prop:"auditState",label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:e.colorList[t.row.auditState]}},[e._v(e._s(e.auditList[t.row.auditState]))])]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.row.auditState,expression:"scope.row.auditState == 1"}],attrs:{plain:""},on:{click:function(n){return e.handleRervert(t.row)}}},[e._v("撤销")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:2==t.row.auditState,expression:"scope.row.auditState == 2"}],attrs:{type:"success",plain:""},on:{click:function(n){return e.handlePublish(t.row)}}},[e._v("发布")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:3==t.row.auditState,expression:"scope.row.auditState == 3"}],attrs:{type:"primary",plain:""},on:{click:function(n){return e.handleUpdate(t.row)}}},[e._v("更新")])]}}])})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},mt=[],gt={components:{},data:function(){return{dataSource:[],colorList:["","warning","success","danger"],auditList:["草稿箱","审核中","已通过","未通过"],currentPage:1,pageSize:5}},computed:{},watch:{},methods:{handleCurrentChange:function(e){this.currentPage=e},handleRervert:function(e){var t=this;this.dataSource=this.dataSource.filter((function(t){return t.id!==e.id})),this.$axios.patch("/news/".concat(e.id),{auditState:0}).then((function(){t.$notify({title:"通知",message:"您可以到草稿箱中查看您的新闻",position:"bottom-right",type:"success"})}))},handlePublish:function(e){var t=this;this.$axios.patch("/news/".concat(e.id),{publishState:2,publishTime:Date.now()}).then((function(){t.$router.push("/publish-manage/published"),t.$notify({title:"通知",message:"您可以到【发布管理/已经发布】中查看您的新闻",position:"bottom-right",type:"success"}),t.$store.commit("SetActive","/publish-manage/published")}))},handleUpdate:function(e){this.$router.push("/news-manage/update/".concat(e.id)),this.$store.commit("SetActive","/news-manage/update/".concat(e.id))}},created:function(){var e=this,t=JSON.parse(localStorage.getItem("token")),n=t.username;this.$axios.get("/news?author=".concat(n,"&auditState_ne=0&publishState_lte=1&_expand=category")).then((function(t){e.dataSource=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},bt=gt,vt=(n("241d"),Object(f["a"])(bt,ht,mt,!1,null,"14954a04",null)),wt=vt.exports,yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("NewsPublish",{attrs:{type:2}})],1)},St=[],_t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"NewsPublish"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataSource.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[n("el-table-column",{attrs:{prop:"title",label:"新闻标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:"/news-manage/preview/"+t.row.id}},[e._v(e._s(t.row.title))])]}}])}),n("el-table-column",{attrs:{prop:"author",label:"作者",width:"180"}}),n("el-table-column",{attrs:{prop:"category.title",label:"新闻分类"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:e.color,plain:1!==e.type},on:{click:function(n){return e.operation(t.row,e.type)}}},[e._v(e._s(e.button))]),e._t("default")]}}],null,!0)})],1),n("el-pagination",{attrs:{align:"right",background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:" prev, pager, next",total:e.dataSource.length},on:{"current-change":e.handleCurrentChange}})],1)},xt=[],Ct=(n("a9e3"),{props:{type:Number},components:{},data:function(){return{dataSource:[],currentPage:1,pageSize:5}},computed:{button:function(){var e;return e=1===this.type?"发布":2===this.type?"下线":"删除",e},color:function(){var e;return e=1===this.type?"primary":(this.type,"danger"),e}},watch:{},methods:{operation:function(e,t){var n=this;1===t?(this.dataSource=this.dataSource.filter((function(t){return t.id!==e.id})),this.$axios.patch("/news/".concat(e.id),{publishState:2,publishTime:Date.now()}).then((function(){n.$notify({title:"通知",message:"您可以到【发布管理/已经发布】中查看您的新闻",position:"bottom-right",type:"success"})}))):2===t?(this.dataSource=this.dataSource.filter((function(t){return t.id!==e.id})),this.$axios.patch("/news/".concat(e.id),{publishState:3}).then((function(){n.$notify({title:"通知",message:"您可以到【发布管理/已下线】中查看您的新闻",position:"bottom-right",type:"success"})}))):3===t&&(this.dataSource=this.dataSource.filter((function(t){return t.id!==e.id})),this.$axios.delete("/news/".concat(e.id)).then((function(){n.$notify({title:"通知",message:"您已经删除了已下线的新闻",position:"bottom-right",type:"success"})})))},handleCurrentChange:function(e){this.currentPage=e}},created:function(){var e=this,t=JSON.parse(localStorage.getItem("token")),n=t.username;this.$axios.get("/news?author=".concat(n,"&publishState=").concat(this.type,"&_expand=category")).then((function(t){e.dataSource=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}}),$t=Ct,kt=(n("3d76"),Object(f["a"])($t,_t,xt,!1,null,"221c2b1e",null)),It=kt.exports,Ft={components:{NewsPublish:It},data:function(){return{dataSource:[]}},computed:{},watch:{},methods:{handleDelete:function(e){console.log(e)}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Ot=Ft,Pt=(n("62d8"),Object(f["a"])(Ot,yt,St,!1,null,"521dd333",null)),Lt=Pt.exports,jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("NewsPublish",{attrs:{type:3}})],1)},Nt=[],Dt={components:{NewsPublish:It},data:function(){return{dataSource:[]}},computed:{},watch:{},methods:{handleDelete:function(e){console.log(e)}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},zt=Dt,At=(n("6ff6"),Object(f["a"])(zt,jt,Nt,!1,null,"52779f0c",null)),Et=At.exports,Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("NewsPublish",{attrs:{type:1}})],1)},Mt=[],Tt={components:{NewsPublish:It},data:function(){return{dataSource:[]}},computed:{},watch:{},methods:{handleDelete:function(e){console.log(e)}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Rt=Tt,Bt=(n("e0ef"),Object(f["a"])(Rt,Ut,Mt,!1,null,"10aa15de",null)),Jt=Bt.exports,qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"newsAdd"},[n("a-page-header",{attrs:{title:"撰写新闻",subTitle:"This is a subtitle"}}),n("el-steps",{attrs:{active:e.current,"finish-status":"success","align-center":""}},[n("el-step",{attrs:{title:"基本信息",description:"新闻标题，新闻分类"}}),n("el-step",{attrs:{title:"新闻内容",description:"新闻主体内容"}}),n("el-step",{attrs:{title:"新闻提交",description:"保存草稿或者提交审核"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current === 0"}],staticStyle:{"margin-top":"40px"}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"新闻标题",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入新闻标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),n("el-form-item",{attrs:{label:"新闻分类",prop:"categoryId"}},[n("el-select",{attrs:{placeholder:"请选择",size:"medium"},model:{value:e.ruleForm.categoryId,callback:function(t){e.$set(e.ruleForm,"categoryId",t)},expression:"ruleForm.categoryId"}},e._l(e.categoryList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current === 1"}],staticStyle:{"margin-top":"40px"}},[n("NewsEditor",{attrs:{formInline:e.formInline}})],1),n("div",[n("span",{directives:[{name:"show",rawName:"v-show",value:2===e.current,expression:"current === 2"}]},[n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){return e.handleSave(0)}}},[e._v("保存草稿箱")]),n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"success",plain:""},on:{click:function(t){return e.handleSave(1)}}},[e._v("提交审核")])],1),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.current<2,expression:"current < 2"}],staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步 ")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.current>0,expression:"current > 0"}],staticStyle:{"margin-top":"12px"},on:{click:e.handlePrevious}},[e._v("上一步")])],1)],1)},Ht=[],Vt={components:{NewsEditor:He},data:function(){return{current:0,categoryList:[],ruleForm:{title:"",categoryId:0},rules:{title:[{required:!0,message:"请输入新闻标题",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类",trigger:"blur"}]},formInline:{contentFileList:""}}},computed:{},watch:{},methods:{handlePrevious:function(){this.current=this.current-1,console.log(this.current)},handleNext:function(){var e=this;0===this.current?this.$refs.ruleForm.validate((function(t){t&&(console.log(e.ruleForm),e.current=e.current+1)})):""===this.formInline.contentFileList||"<p></p>"===this.formInline.contentFileList.trim()?this.$message.error("新闻内容不能为空"):(console.log(this.formInline.contentFileList),this.current=this.current+1)},handleSave:function(e){var t=this;this.$axios.patch("/news/".concat(this.$route.params.id),Object(P["a"])(Object(P["a"])({},this.ruleForm),{},{content:this.formInline.contentFileList,auditState:e})).then((function(){t.$router.push(0===e?"/news-manage/draft":"/audit-manage/list"),t.$notify({title:"通知",message:"您可以到".concat(0===e?"草稿箱":"审核列表","中查看您的新闻"),position:"bottom-right",type:"success"}),t.$store.commit("SetActive",0===e?"/news-manage/draft":"/audit-manage/list")}))}},created:function(){var e=this;this.$axios.get("/categories").then((function(t){e.categoryList=t.data})),this.$axios.get("/news/".concat(this.$route.params.id,"?_expand=category&_expand=role")).then((function(t){var n=t.data,r=n.title,a=n.categoryId,i=n.content;e.ruleForm.title=r,e.ruleForm.categoryId=a,e.formInline.contentFileList=i,console.log(t.data)}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Yt=Vt,Kt=(n("9d18"),Object(f["a"])(Yt,qt,Ht,!1,null,"1d464dfc",null)),Xt=Kt.exports,Gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail"},[e.newsInfo.title&&e.newsInfo.category.title?n("a-page-header",{attrs:{title:e.newsInfo.title,"sub-title":e.newsInfo.category.title},on:{back:e.back}}):e._e(),n("a-descriptions",{staticStyle:{padding:"0 24px"},attrs:{size:"small"}},[n("a-descriptions-item",{attrs:{label:"创建者"}},[e._v(e._s(e.newsInfo.author)+" ")]),n("a-descriptions-item",{attrs:{label:"创建时间"}},[e._v(" "+e._s(e.time)+" ")]),n("a-descriptions-item",{attrs:{label:"发布时间"}},[e._v(" "+e._s(e._)+" ")]),n("a-descriptions-item",{attrs:{label:"区域"}},[e._v(" "+e._s(e.newsInfo.region)+" ")]),n("a-descriptions-item",{attrs:{label:"审核状态"}},[n("el-tag",{attrs:{type:e.colorList[e.newsInfo.auditState]}},[e._v(e._s(e.auditList[e.newsInfo.auditState]))])],1),n("a-descriptions-item",{attrs:{label:"发布状态"}},[n("span",[e._v(e._s(e.publishList[e.newsInfo.publishState]))])]),n("a-descriptions-item",{attrs:{label:"访问数量"}},[e._v(" "+e._s(e.newsInfo.view)+" ")]),n("a-descriptions-item",{attrs:{label:"点赞数量"}},[e._v(" "+e._s(e.newsInfo.star)+" ")]),n("a-descriptions-item",{attrs:{label:"评论数量"}},[e._v(" 0 ")])],1),n("div",{staticStyle:{margin:"0 24px",border:"1px solid gray"},domProps:{innerHTML:e._s(e.newsInfo.content)}})],1)},Wt=[],Qt={name:"Detail",components:{},data:function(){return{newsInfo:[],publishList:["未发布","待发布","已上线","已下线"],auditList:["未审核","审核中","已通过","未通过"],colorList:["info","warning","success","danger"]}},computed:{time:function(){return this.$day(this.newsInfo.publishTime).format("YYYY/MM/DD HH:mm:ss")}},watch:{},methods:{back:function(){this.$router.go(-1)}},created:function(){var e=this;this.$axios.get("/news/".concat(this.$route.params.id,"?_expand=category&_expand=role")).then((function(t){e.newsInfo=t.data}))},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Zt=Qt,en=(n("4b40"),Object(f["a"])(Zt,Gt,Wt,!1,null,"0c7074e7",null)),tn=en.exports;s["default"].use(m["a"]);var nn=[{path:"/login",name:"Login",component:S},{path:"/news",name:"News",component:I},{path:"/detail/:id",name:"Detail",component:D},{path:"*",name:"Main",component:ie,meta:{isAuth:!0},children:[{path:"/home",name:"Home",component:de,meta:{isAuth:!0}},{path:"/user-manage/list",name:"UserList",component:Ce,meta:{isAuth:!0}},{path:"/right-manage/role/list",name:"RoleList",component:Ae,meta:{isAuth:!0}},{path:"/right-manage/right/list",name:"RightList",component:Pe,meta:{isAuth:!0}},{path:"/news-manage/add",name:"NewsAdd",component:Xe,meta:{isAuth:!0}},{path:"/news-manage/draft",name:"NewsDraft",component:st,meta:{isAuth:!0}},{path:"/news-manage/category",name:"NewsCategory",component:tt,meta:{isAuth:!0}},{path:"/audit-manage/list",name:"AuditList",component:wt,meta:{isAuth:!0}},{path:"/audit-manage/audit",name:"Audit",component:pt,meta:{isAuth:!0}},{path:"/publish-manage/unpublished",name:"Unpublished",component:Jt,meta:{isAuth:!0}},{path:"/publish-manage/published",name:"Published",component:Lt,meta:{isAuth:!0}},{path:"/publish-manage/sunset",name:"Sunset",component:Et,meta:{isAuth:!0}},{path:"/news-manage/update/:id",name:"NewsUpdate",component:Xt,meta:{isAuth:!0}},{path:"/news-manage/preview/:id",name:"NewsPreview",component:tn,meta:{isAuth:!0}}]}],rn=new m["a"]({mode:"history",base:"/vue/",routes:nn});rn.beforeEach((function(e,t,n){"/"==e.path&&(window.sessionStorage.setItem("activePath","/home"),n({path:"/home"})),e.meta.isAuth?localStorage.getItem("token")?n():n({path:"/login"}):n()}));var an=rn;s["default"].use(M["a"]);var on=new M["a"].Store({state:{isCollapse:!1,activePath:sessionStorage.getItem("activePath")?sessionStorage.getItem("activePath"):"/home"},mutations:{OPEN:function(e){e.isCollapse=!e.isCollapse},SetActive:function(e,t){sessionStorage.setItem("activePath",t),e.activePath=sessionStorage.getItem("activePath")},ClearActive:function(e){e.activePath="/home",sessionStorage.removeItem("activePath")},ClearIsCollapse:function(e){e.isCollapse=!1}},actions:{},modules:{}}),sn=n("5c96"),cn=n.n(sn),ln=(n("0fae"),n("bc3a")),un=n.n(ln),dn=(n("840a"),n("98c9")),fn=n("313e"),pn=n("2ef0"),hn=n.n(pn);un.a.defaults.baseURL="http://101.43.137.36:2246";var mn=n("5a0c"),gn=n.n(mn);n("7eef");s["default"].prototype.$axios=un.a,s["default"].use(r["b"]).use(a["a"]).use(i["a"]).use(o["a"]),s["default"].prototype.$day=gn.a,s["default"].prototype._=hn.a,s["default"].prototype.$echarts=fn,s["default"].use(dn["a"]),s["default"].config.productionTip=!1,s["default"].use(cn.a),s["default"].use(Re["e"],{lang:"zh"}),new s["default"]({router:an,store:on,render:function(e){return e(h)}}).$mount("#app")},5891:function(e,t,n){},"62bc":function(e,t,n){},"62d8":function(e,t,n){"use strict";n("1702")},"6d26":function(e,t,n){},"6ff6":function(e,t,n){"use strict";n("09b8")},7295:function(e,t,n){"use strict";n("9aaa")},7361:function(e,t,n){},"738f":function(e,t,n){},"78f8":function(e,t,n){},"85ec":function(e,t,n){},"9aaa":function(e,t,n){},"9d18":function(e,t,n){"use strict";n("4992")},c4db:function(e,t,n){},c9ff:function(e,t,n){},cc5e:function(e,t,n){},cce2:function(e,t,n){},d18b:function(e,t,n){},d743:function(e,t,n){"use strict";n("c9ff")},dcb4:function(e,t,n){"use strict";n("78f8")},e0ef:function(e,t,n){"use strict";n("7361")},e152:function(e,t,n){},ec52:function(e,t,n){"use strict";n("d18b")},f00a:function(e,t,n){"use strict";n("4dc9")},f635:function(e,t,n){"use strict";n("342e")},fb13:function(e,t,n){"use strict";n("cc5e")}});
//# sourceMappingURL=app.beac6385.js.map